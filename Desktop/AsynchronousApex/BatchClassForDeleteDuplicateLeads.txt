public with sharing class RemoveDuplicateLeads implements database.Batchable<SObject>, Database.stateful,  Schedulable{
    public Database.QueryLocator start(Database.BatchableContext bc){
        return Database.getQueryLocator('Select Id, Name, LastName, Company, Status, Email from Lead ');
    }
    
    public void execute(Database.BatchableContext bc, List<Lead> l){
       
        Map<String,Lead> LastNameLead = new Map<String,Lead>(); 
        
        list<Lead> duplicateToDelete = new list<Lead>();
        
        for (Lead leadObj : l)
        {
            
            If(!LastNameLead.containskey(leadObj.LastName) ){
                LastNameLead.put(leadObj.LastName, leadObj);
                system.debug(LastNameLead);
            }
            else{
                duplicateToDelete.add(leadObj);
                system.debug(duplicateToDelete);
            }
   
        }
        
        if(duplicateToDelete.size() > 0)
        {
            delete duplicateToDelete;
        }
    
    }

    public void finish(Database.BatchableContext bc)
    {
        
    }
    
    public void execute(SchedulableContext sc) {       
        RemoveDuplicateLeads lb = new RemoveDuplicateLeads();
        ID batchprocessid = Database.executeBatch(lb);
        String cronExp = '0 0 0/2 ? * * *';
        String jobIDNew = system.schedule('Batch Scheduled', cronExp, lb);
        
    }
    
}